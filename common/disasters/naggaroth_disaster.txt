#Naggaroth Power Struggle
naggaroth_power_struggle = {
	potential = {
		has_dlc = "Domination"
		tag = H12
		normal_or_historical_nations = yes
		NOT = { has_country_flag = naggaroth_power_struggle_has_happened }
		has_government_mechanic = ottoman_decadence_mechanic
	}
	can_start = {
		has_government_power = {
			mechanic_type = ottoman_decadence_mechanic 
			power_type = ottoman_decadence 
			value = 100
		}
		OR = {
			NOT = { stability = 3 }
			NOT = { adm = 5 }
			NOT = { dip = 5 }
			NOT = { mil = 5 }
			any_subject_country = {
				liberty_desire = 50
			}
		}
	}
	can_stop = {
		NOT = {
			has_government_power = {
				mechanic_type = ottoman_decadence_mechanic 
				power_type = ottoman_decadence 
				value = 75
			}
		}
		stability = 3
		adm = 5
		dip = 5
		mil = 5
		NOT = { overextension_percentage = 0.25 }
		NOT = { num_of_rebel_armies = 1 }
		NOT = { num_of_rebel_controlled_provinces = 1 }
		NOT = {
			any_subject_country = {
				liberty_desire = 50
			}
		}
		NOT = {
			legitimacy = 90
		}
	}
	progress = {
		modifier = {
			factor = 1
			NOT = {
				legitimacy = 90
			}	
		}
		modifier = {
			factor = 1
			any_subject_country = {
				liberty_desire = 50
			}
		}
		modifier = {
			factor = 1
			overextension_percentage = 0.25
		}
		modifier = {
			factor = 1
			num_of_rebel_armies = 1
		}
		modifier = {
			factor = 1
			num_of_rebel_controlled_provinces = 1
		}
		modifier = {
			factor = 100
			NOT = { stability = 3 }
		}
		modifier = {
			factor = 1
			NOT = { adm = 5 }
			NOT = { dip = 5 }
			NOT = { mil = 5 }
		}
	}
	can_end = {
		stability = 3
		legitimacy = 100
		if = {
			limit = { has_mission = h12_restrict_corsairs }
			mission_completed = h12_restrict_corsairs
		}
		if = {
			limit = { has_mission = h12_quell_cults }
			mission_completed = h12_quell_cults
		}
		if = {
			limit = { has_mission = h12_crush_dreadlords }
			mission_completed = h12_crush_dreadlords
		}
		if = {
			limit = { has_mission = h12_obliterate_merchants }
			mission_completed = h12_obliterate_merchants
		}
	}
	modifier = {
		global_unrest = 5
	}
	on_start = naggaroth_power_struggle_events.1
	on_end = naggaroth_power_struggle_events.2
	on_start_effect = {
		freeze_government_power = {
			mechanic_type = ottoman_decadence_mechanic
			power_type = ottoman_decadence
		}
	}
	on_monthly = {
		events = {
		}
		random_events = {
			1000 = 0
			50 = naggaroth_power_struggle_events.3
			50 = naggaroth_power_struggle_events.4
			50 = naggaroth_power_struggle_events.5
			10 = naggaroth_power_struggle_events.6
			50 = naggaroth_power_struggle_events.7
			10 = naggaroth_power_struggle_events.8
		}
	}
	ended_by_country_breaking_to_rebels = no
}

#Dreadlords Secede
naggaroth_dreadlords_secede = {
	potential = {
		has_disaster = naggaroth_power_struggle
	}
	can_start = {
		has_estate = estate_nobles
		NOT = { legitimacy = 75 }
		OR = {
			NOT = {
				num_of_estate_privileges = {
					estate = estate_nobles
					value = 5
				}
			}
			NOT = {
				estate_loyalty = {
					estate = estate_nobles
					loyalty = 60
				}
			}
		}
	}
	can_stop = {
		legitimacy = 90
		OR = {
			NOT = {
				estate_influence = {
					influence = 10
					estate = estate_nobles
				}
			}
			estate_loyalty = {
				estate = estate_nobles
				loyalty = 80
			}
		}
	}
	progress = {
		modifier = {
			factor = -2
			estate_loyalty = { estate = estate_nobles loyalty = 70 }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 60 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 50 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 40 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 30 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 20 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_nobles loyalty = 10 } }
		}
		modifier = {
			factor = 2
			estate_influence = { estate = estate_nobles influence = 60 }
		}
	}
	can_end = {
		OR = {
			NOT = { has_disaster = naggaroth_power_struggle }
			custom_trigger_tooltip = {
				tooltip = naggaroth_dreadlords_secede_at
				AND = {
					OR = {
						has_country_flag = defeated_hag_graef
						has_country_flag = hag_graef_secedes
					}
					OR = {
						has_country_flag = defeated_ghrond
						has_country_flag = ghrond_secedes
					}
					OR = {
						has_country_flag = defeated_har_ganeth
						has_country_flag = har_ganeth_secedes
					}
					OR = {
						has_country_flag = defeated_clar_karond
						has_country_flag = clar_karond_secedes
					}
					OR = {
						has_country_flag = defeated_karond_kar
						has_country_flag = karond_kar_secedes
					}
				}
			}
		}
	}
	modifier = {
		nobles_influence_modifier = 0.1
	}
	on_start = dreadlords_secede_events.1
	on_end = dreadlords_secede_events.2
	on_monthly = {
		events = {
		}
		random_events = { 
			1250 = 0
			10 = dreadlords_secede_events.4
			10 = dreadlords_secede_events.5
			10 = dreadlords_secede_events.6
			10 = dreadlords_secede_events.7
			10 = dreadlords_secede_events.8
			10 = dreadlords_secede_events.9
			5 = dreadlords_secede_events.10
		}
	}
	ended_by_country_breaking_to_rebels = no
}
#Cultist Catastrophe
naggaroth_cultist_catastrophe = {
	potential = {
		has_disaster = naggaroth_power_struggle
	}
	can_start = {
		has_estate = estate_church
		NOT = { religious_unity = 1 }
		OR = {
			NOT = {
				num_of_estate_privileges = {
					estate = estate_church
					value = 5
				}
			}
			NOT = {
				estate_loyalty = {
					estate = estate_church
					loyalty = 60
				}
			}
		}
	}
	can_stop = {
		religious_unity = 1
		OR = {
			NOT = {
				estate_influence = {
					influence = 10
					estate = estate_church
				}
			}
			estate_loyalty = {
				estate = estate_church
				loyalty = 80
			}
		}
	}
	progress = {
		modifier = {
			factor = -2
			religious_unity = 1
		}
		modifier = {
			factor = 2 
			NOT = { religious_unity = .9 }
		}
		modifier = {
			factor = 2 
			NOT = { religious_unity = .7 }
		}
		modifier = {
			factor = 2 
			NOT = { religious_unity = .5 }
		}
		modifier = {
			factor = -2
			estate_loyalty = { estate = estate_church loyalty = 70 }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 60 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 50 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 40 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 30 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 20 } }
		}
		modifier = {
			factor = 2
			NOT = { estate_loyalty = { estate = estate_church loyalty = 10 } }
		}
		modifier = {
			factor = 2
			estate_influence = { estate = estate_nobles influence = 60 }
		}
	}
	modifier = {
		church_influence_modifier = 0.1
		tolerance_heretic = -10
		tolerance_own = -5
	}
	on_start = church_catastrophe_events.1
	on_end = church_catastrophe_events.2
	on_monthly = {
		events = {
		}
		random_events = { 
			1250 = 0
			10 = church_catastrophe_events.3
			10 = church_catastrophe_events.5
			10 = church_catastrophe_events.6
			10 = church_catastrophe_events.7
			10 = church_catastrophe_events.8
			10 = church_catastrophe_events.9
			5 = church_catastrophe_events.10
		}
	}
	ended_by_country_breaking_to_rebels = no
}