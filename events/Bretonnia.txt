

### Reform Events ####
### Reform Events ####
### Reform Events ####
# Start of Event
country_event = {
	id = flavor_bretonnia.200
	title = flavor_bretonnia.200.t
	desc = flavor_bretonnia.200.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_bretonnia.200.a
		hidden_effect = {
			set_variable = {
				which = brt_adm
				value = 0
			}
			set_variable = {
				which = brt_dip
				value = 0
			}
			set_variable = {
				which = brt_mil
				value = 0
			}
		}
	}
}

# Warfare
country_event = {
	id = flavor_bretonnia.210
	title = flavor_bretonnia.210.t
	desc = flavor_bretonnia.210.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.210.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.210.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.210.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
}

# The Fey
country_event = {
	id = flavor_bretonnia.220
	title = flavor_bretonnia.220.t
	desc = flavor_bretonnia.220.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.220.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.220.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.220.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
}

# Estates are worried about their power
country_event = {
	id = flavor_bretonnia.230
	title = flavor_bretonnia.230.t
	desc = flavor_bretonnia.230.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.230.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.230.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.230.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
}

# Little Economical Golden Age
country_event = {
	id = flavor_bretonnia.240
	title = flavor_bretonnia.240.t
	desc = flavor_bretonnia.240.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.240.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.240.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.240.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
}

# Religious Debate
country_event = {
	id = flavor_bretonnia.250
	title = flavor_bretonnia.250.t
	desc = flavor_bretonnia.250.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.250.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.250.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.250.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
}

# Role of the Monarch
country_event = {
	id = flavor_bretonnia.260
	title = flavor_bretonnia.260.t
	desc = flavor_bretonnia.260.desc
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	option = {
		#ADM 
		name = flavor_bretonnia.260.a
		change_variable = {
			which = brt_adm
			value = 1
		}
	}
	option = {
		#DIP
		name = flavor_bretonnia.260.b
		change_variable = {
			which = brt_dip
			value = 1
		}
	}
	option = {
		#MIL
		name = flavor_bretonnia.260.c
		change_variable = {
			which = brt_mil
			value = 1
		}
	}
	#The lady is the true ruler of Bretonnia ie become a theocracy
	# option = {
	# 	#MIL
	# 	name = flavor_bretonnia.260.c
	# 	change_variable = {
	# 		which = brt_mil
	# 		value = 1
	# 	}
	# }
}



### Grail Quest


### Grail Quest Feeder
country_event = {
	id = flavor_bretonnia.899
	title = flavor_bretonnia.899.t
	desc = flavor_bretonnia.899.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = no
	hidden = yes

	trigger = {
		has_country_modifier = heir_on_grail_quest_modifier
		NOT = { has_country_flag = heir_considering_quest }
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = flavor_bretonnia.899.a
		ai_chance = {
			factor = 1
		}

		random_list = {
		    10 = { country_event = { id = flavor_bretonnia.901 } }
		    10 = { country_event = { id = flavor_bretonnia.902 } }
		    10 = { country_event = { id = flavor_bretonnia.903 } }
		    10 = { country_event = { id = flavor_bretonnia.904 } }
		    10 = { country_event = { id = flavor_bretonnia.905 } }
		    10 = { country_event = { id = flavor_bretonnia.906 } }
		    10 = { country_event = { id = flavor_bretonnia.907 } }
		    30 = { country_event = { id = flavor_bretonnia.910 } }
		}
	}
}



### Heir Sets out on a Grail Quest!
country_event = {
	id = flavor_bretonnia.900
	title = flavor_bretonnia.900.t
	desc = flavor_bretonnia.900.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes
	trigger = {
		has_heir = yes
		is_lesser_in_union = no
	}
	immediate = {
		hidden_effect = {
			set_variable = {
				which = heirGrailQuestLevel
				value = 0
			}
			clr_country_flag = heir_considering_quest
		}
		set_saved_name = {
			# intentionally not cleared here
			key = grail_quest_heir_name
			type = advisor
			scope = ROOT
		}
	}
	option = {
		name = flavor_bretonnia.900.a
		set_heir_flag = heir_on_grail_quest
		ai_chance = {
			factor = 1
		}
	}

	after = {
		clr_country_flag = heir_considering_quest
	}


}



### Heir encounters a monster
country_event = {
	id = flavor_bretonnia.901
	title = flavor_bretonnia.901.t
	desc = flavor_bretonnia.901.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes


	immediate = { 
		set_country_flag = heir_considering_quest
	}

# Fight the Monster!	
	option = {
		name = flavor_bretonnia.901.a
		ai_chance = {
			factor = 1
		}

		change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_prestige = 5
		add_heir_claim = 5

		random = { 
		    chance = 20 
		    kill_heir = {}
		}

	}

# My men will fight it
	option = {
		name = flavor_bretonnia.901.b
		ai_chance = {
			factor = 1
		}
		add_manpower = -1

		change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_prestige = -5
		random = { 
		    chance = 5
		    kill_heir = {}
		}

	}

# Flee!
	option = {
		name = flavor_bretonnia.901.c
		ai_chance = {
			factor = 1
		}
		add_prestige = -5
		add_heir_claim = -5

	}


	after = {
		clr_country_flag = heir_considering_quest
	}

}


### Heir encounters a beggar
country_event = {
	id = flavor_bretonnia.902
	title = flavor_bretonnia.902.t
	desc = flavor_bretonnia.902.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}

# Make a large donation	
	option = {
		name = flavor_bretonnia.902.a
		ai_chance = {
			factor = 1
		}

		change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_treasury = -50
		add_heir_claim = 5

	}

# Make a small donation
	option = {
		name = flavor_bretonnia.902.b
		ai_chance = {
			factor = 1
		}
		add_treasury = -10
		random = { 
		    chance = 50
		    change_variable = {
				which = heirGrailQuestLevel
				value = 1
			}
		}
	}

# Move on
	option = {
		name = flavor_bretonnia.902.c
		ai_chance = {
			factor = 1
		}
		add_prestige = -5
		add_heir_claim = -5

	}


	after = {
		clr_country_flag = heir_considering_quest
	}

}



### Heir overhears an insult to the kingdom
country_event = {
	id = flavor_bretonnia.903
	title = flavor_bretonnia.903.t
	desc = flavor_bretonnia.903.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}

# Challenge to a duel!
	option = {
		name = flavor_bretonnia.903.a
		ai_chance = {
			factor = 1
		}

		change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_prestige = 10
		add_heir_claim = 10

		random = { 
		    chance = 20 
		    kill_heir = {}
		}

	}

# Throw your wine at him, and leave
	option = {
		name = flavor_bretonnia.903.b
		ai_chance = {
			factor = 1
		}
		add_treasury = -1
		random = { 
		    chance = 1 
		    kill_heir = {}
		}

	    change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}
	}

# Move on - it's not worth the trouble
	option = {
		name = flavor_bretonnia.903.c
		ai_chance = {
			factor = 1
		}
		add_legitimacy = -5
		add_heir_claim = -5

	}

	after = {
		clr_country_flag = heir_considering_quest
	}

}




### There is a tournament in town!
country_event = {
	id = flavor_bretonnia.904
	title = flavor_bretonnia.904.t
	desc = flavor_bretonnia.904.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}


# Let's join in
	option = {
		name = flavor_bretonnia.904.a
		ai_chance = {
			factor = 1
		}

		add_treasury = -5

		random_list = {
			5 = {
				add_prestige = 15
				add_treasury = 50
				add_heir_claim = 15
			}
			45 = {
				add_prestige = 5
				add_heir_claim = 5
			}
			45 = {
				add_prestige = -5
				add_heir_claim = -5
			}
			5 = {
				add_prestige = -15
				kill_heir = {}
			}
		}

	}

# No point, let us focus on the grail
	option = {
		name = flavor_bretonnia.904.b
		ai_chance = {
			factor = 1
		}

	    change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}
	}


	after = {
		clr_country_flag = heir_considering_quest
	}

}



### We are running out of money
country_event = {
	id = flavor_bretonnia.905
	title = flavor_bretonnia.905.t
	desc = flavor_bretonnia.905.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}

# Send the cash
	option = {
		name = flavor_bretonnia.905.a
		ai_chance = {
			factor = 1
		}

	    change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_treasury = -100

	}

# Let's head home for now
	option = {
		name = flavor_bretonnia.905.b
		ai_chance = {
			factor = 1
		}
		remove_country_modifier = heir_on_grail_quest_modifier


		hidden_effect = {
			set_variable = {
				which = heirGrailQuestLevel
				value = 0
			}
		}
	}


	after = {
		clr_country_flag = heir_considering_quest
	}


}



### A fortune teller offers to tell our fortunes, though the truth may drive us mad
country_event = {
	id = flavor_bretonnia.906
	title = flavor_bretonnia.906.t
	desc = flavor_bretonnia.906.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}


# Yes, but
	option = {
		name = flavor_bretonnia.906.a
		ai_chance = {
			factor = 1
		}

		add_treasury = -5

		random_list = {
			90 = {
			    change_variable = {
					which = heirGrailQuestLevel
					value = 3
				}
			}
			5 = {
				change_heir_adm = -1
				change_heir_dip = -1
				change_heir_mil = -1
			}
			5 = {
				kill_heir = {}
			}
		}

	}

# No way!
	option = {
		name = flavor_bretonnia.906.b
		ai_chance = {
			factor = 1
		}
	}

	after = {
		clr_country_flag = heir_considering_quest
	}


}



### Is this an obsession?
country_event = {
	id = flavor_bretonnia.907
	title = flavor_bretonnia.907.t
	desc = flavor_bretonnia.907.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}

# No! We must press forward, no matter what people may say
	option = {
		name = flavor_bretonnia.907.a
		ai_chance = {
			factor = 1
		}

	    change_variable = {
			which = heirGrailQuestLevel
			value = 1
		}

		add_prestige = -5
		add_heir_claim = -5

	}

# Let's head home
	option = {
		name = flavor_bretonnia.907.b
		ai_chance = {
			factor = 1
		}

		remove_country_modifier = heir_on_grail_quest_modifier

		hidden_effect = {
			set_variable = {
				which = heirGrailQuestLevel
				value = 0
			}
		}
	}


	after = {
		clr_country_flag = heir_considering_quest
	}


}


### Determines Grail Outcome
## Title here should be "A Journey's End?"
country_event = {
	id = flavor_bretonnia.910
	title = flavor_bretonnia.910.t
	desc = flavor_bretonnia.910.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes
	hidden = yes


	option = {
		name = flavor_bretonnia.910.a
		ai_chance = { factor = 1 }

		### The Grail is found!
		if = {
			limit = {
				check_variable = {
				    which = heirGrailQuestLevel
				    value = 20
				}
				NOT = { has_global_flag = grail_has_been_found }
			}

			country_event = { 
    			id = flavor_bretonnia.912
			}

		}

		## A good quest
		else_if = {
			limit = {
				check_variable = {
				    which = heirGrailQuestLevel
				    value = 5
				}
			}

			country_event = { 
    			id = flavor_bretonnia.911
			}
		}

		## Continuing on...
		else = {

		}
	}

}


#Heir Returns from Quest! He didn't find the grail, but it was a worthy quest, and he made a name for himself
country_event = {
	id = flavor_bretonnia.911
	title = flavor_bretonnia.911.t
	desc = flavor_bretonnia.911.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		set_country_flag = heir_considering_quest
	}

# Come home, we've won enough glory!	
	option = {
		# He shall once again be our heir
		name = flavor_bretonnia.911.a
		ai_chance = { factor = 1 }

		hidden_effect = { remove_all_heir_personalities = yes }
		add_heir_personality = grail_knight_personality
		set_heir_flag = grail_knight
		remove_country_modifier = heir_on_grail_quest_modifier

		hidden_effect = {
				set_variable = {
					which = heirGrailQuestLevel
					value = 0
				}

		}
	}

# Castle life is so boring! Back to the road!
	option = {
		name = flavor_bretonnia.911.b
		trigger = { NOT = { has_global_flag = grail_has_been_found } }
		ai_chance = { factor = 1 }
		add_treasury = -100
	}

	after = {
		clr_country_flag = heir_considering_quest
	}


}

# He found the grail! The Lady of the Lake has taken the unprecedented move of giving the grail to this paragon of virtue. Future knights will drink from the water pooled in the lady's hands.

country_event = {
	id = flavor_bretonnia.912
	title = flavor_bretonnia.912.t
	desc = flavor_bretonnia.912.d
	picture = KNIGHTS_eventPicture
	is_triggered_only = yes

	immediate = { 
		hidden_effect = { remove_all_heir_personalities = yes }
		ai_chance = { factor = 1 }
		add_heir_personality = grail_knight_personality
		set_heir_flag = grail_knight
		remove_country_modifier = heir_on_grail_quest_modifier

		hidden_effect = {
			set_variable = {
				which = heirGrailQuestLevel
				value = 0
			}
		}

		set_global_flag = grail_has_been_found
	}

	option = {
		name = flavor_bretonnia.912.a

		capital_scope = {
			add_permanent_province_modifier = { 
			    name = location_of_the_grail
			    duration = -1  
			}
		}


	}
}

## We are Bretonnians - proud, and chivalrous. Some might say that we are backwards, and that we abuse our peasants, but, while they are technically correct, they couldn't be more wrong! We owe our allegiance to the Royarch, who leads the bretonnian dukedoms in times of strife.
country_event = {
	id = flavor_bretonnia.100
	title = flavor_bretonnia.100.t
	desc = flavor_bretonnia.100.d
	picture = BRETONNIA_eventPicture
	is_triggered_only = yes
	trigger = {
		NOT = {
			is_year = 2503
		}
		OR = {
			has_reform = bretonnian_dukedom_reform
			has_reform = bretonnian_royarch_reform
		}
		NOT= { has_country_flag = did_intro_event }
	}

	immediate = { set_country_flag = did_intro_event }
	## For the lady!
	option = {
		name = flavor_bretonnia.100.a
		ai_chance = { factor = 1 }

		add_army_tradition = 25
	}
}